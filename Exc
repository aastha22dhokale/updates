  location: class com.ing.datadist.api.service.OrganisationUnitService
[INFO] 22 errors
[INFO] -------------------------------------------------------------
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  13.967 s
[INFO] Finished at: 2025-11-17T17:09:39+05:30
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on project DataDistribution: Compilation failure: Compilation failure:
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/exception/DataDistributionApiException.java:[71,29] cannot find symbol
[ERROR]   symbol:   variable UPDATE_EXTERNAL_ID
[ERROR]   location: class com.ing.datadist.api.utils.RegkeyEnum
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[57,23] cannot find symbol       
[ERROR]   symbol:   class DataDistributionApiException
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[58,21] cannot find symbol       
[ERROR]   symbol:   variable RegkeyEnum
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[59,21] cannot find symbol       
[ERROR]   symbol:   variable HttpStatus
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[67,23] cannot find symbol       
[ERROR]   symbol:   class DataDistributionApiException
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[68,21] cannot find symbol       
[ERROR]   symbol:   variable RegkeyEnum
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[69,21] cannot find symbol       
[ERROR]   symbol:   variable HttpStatus
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[84,35] cannot find symbol       
[ERROR]   symbol:   class DataDistributionApiException
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[85,33] cannot find symbol       
[ERROR]   symbol:   variable RegkeyEnum
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[86,33] cannot find symbol       
[ERROR]   symbol:   variable HttpStatus
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[97,35] cannot find symbol       
[ERROR]   symbol:   class DataDistributionApiException
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[98,33] cannot find symbol       
[ERROR]   symbol:   variable RegkeyEnum
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[99,33] cannot find symbol       
[ERROR]   symbol:   variable HttpStatus
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[110,35] cannot find symbol      
[ERROR]   symbol:   class DataDistributionApiException
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[111,33] cannot find symbol      
[ERROR]   symbol:   variable RegkeyEnum
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[112,33] cannot find symbol      
[ERROR]   symbol:   variable HttpStatus
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[128,34] cannot find symbol      
[ERROR]   symbol:   class DataDistributionApiException
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[130,17] cannot find symbol      
[ERROR]   symbol:   class DataDistributionApiException
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[130,52] cannot find symbol      
[ERROR]   symbol:   class DataDistributionApiException
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[143,23] cannot find symbol      
[ERROR]   symbol:   class DataDistributionApiException
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[144,21] cannot find symbol      
[ERROR]   symbol:   variable RegkeyEnum
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] /C:/Users/UU47VT/dd-new/P33558-DataDistributorAPI/DataDistribution/src/main/java/com/ing/datadist/api/service/OrganisationUnitService.java:[145,21] cannot find symbol      
[ERROR]   symbol:   variable HttpStatus
[ERROR]   location: class com.ing.datadist.api.service.OrganisationUnitService
[ERROR] -> [Help 1]
[ERROR]
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR]
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
PS C:\Users\UU47VT\dd-new\P33558-DataDistributorAPI\DataDistribution> 


package com.ing.datadist.api.service;

import com.ing.datadist.api.model.CreateOrganisationUnitRequest;
import com.ing.datadist.api.model.CreateOrganisationUnitNameRequest;
import com.ing.datadist.api.model.InvolvedPartiesOrganisationUnitResponse;
import com.ing.datadist.api.model.UpdateExternalIdentifierOrganisationUnitRequest;
import com.ing.datadist.api.model.OrganisationUnitOrganisationRelationshipRequest;
import com.ing.datadist.configreader.CofaceOpsConfigReader;
import static com.ing.datadist.api.utils.DataDistributionConstants.DATA_SOURCE;
import static com.ing.datadist.api.utils.DataDistributionConstants.LOGICAL_DATA_DOMAIN;
import static com.ing.datadist.api.utils.DataDistributionConstants.LANGUAGE;
import static com.ing.datadist.api.utils.DataDistributionConstants.CHANNEL_OF_ENTRY;
import static com.ing.datadist.api.utils.DataDistributionConstants.ORGANISATION_UNIT_NAME_TYPE;
import static com.ing.datadist.api.utils.DataDistributionConstants.STRUCTURE_TYPE;
import static com.ing.datadist.api.utils.DataDistributionConstants.EXTERNAL_ID_TYPE;
import static com.ing.datadist.api.utils.DataDistributionConstants.EXTERNAL_ID_STATUS;
import static com.ing.datadist.api.utils.DataDistributionConstants.PLACE_OF_ISSUE;
import static com.ing.datadist.api.utils.DataDistributionConstants.ROLE_REASON_TYPE;

import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Service;

import java.time.ZonedDateTime;
import java.time.format.DateTimeFormatter;
import java.util.Collections;
import java.util.List;
import java.util.Map;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.CompletableFuture;

import com.ing.datadist.api.exception.DataDistributionApiException.OrganisationUnitCreationException;
import com.ing.datadist.api.exception.DataDistributionApiException.ExternalIdentifierUpdateException;
import com.ing.datadist.api.exception.DataDistributionApiException.PostalAddressCreationException;
import com.ing.datadist.api.exception.DataDistributionApiException.OrganisationHierarchyCreationException;
import java.util.concurrent.CompletionException;
@Service
@Slf4j
public class OrganisationUnitService {

    private final OnePamRepository onePamRepository;
    private final CofaceOpsConfigReader configReader;
    private final AddressService addressService;

    public OrganisationUnitService(OnePamRepository onePamRepository, CofaceOpsConfigReader configReader, AddressService addressService) {
        this.onePamRepository = onePamRepository;
        this.configReader = configReader;
        this.addressService = addressService;
    }

    public void processOrganisationUnit(String orgNumber) {

        InvolvedPartiesOrganisationUnitResponse response;

        try {
            response = createOrganisationUnit(orgNumber);
        } catch (Exception e) {
            throw new DataDistributionApiException(
                    RegkeyEnum.CREATE_ORGANISATION_UNIT,
                    HttpStatus.INTERNAL_SERVER_ERROR,
                    "Failed to create Organisation Unit for orgNumber=" + orgNumber + " : " + e.getMessage()
            );
        }

        String uuid = response.getInvolvedPartyIdentifier();

        if (uuid == null || uuid.isBlank()) {
            throw new DataDistributionApiException(
                    RegkeyEnum.CREATE_ORGANISATION_UNIT,
                    HttpStatus.NOT_FOUND,
                    "No involvedPartyIdentifier returned for orgNumber=" + orgNumber
            );
        }

        UpdateExternalIdentifierOrganisationUnitRequest updateRequest = buildUpdateRequest(orgNumber);

        final String PARENT_ID = "PARENT-ID";
        final String CHILD_ID = "CHILD-ID";

        CompletableFuture<Void> updateExternalIdentifierAsync =
                CompletableFuture.runAsync(() -> {
                    try {
                        updateExternalIdentifier(uuid, updateRequest);
                    } catch (Exception e) {
                        throw new DataDistributionApiException(
                                RegkeyEnum.UPDATE_EXTERNAL_IDENTIFIER,
                                HttpStatus.BAD_REQUEST,
                                "Failed to update external identifier for uuid=" + uuid + " : " + e.getMessage()
                        );
                    }
                });

        CompletableFuture<Void> createPostalAddressAsync =
                CompletableFuture.runAsync(() -> {
                    try {
                        addressService.createPostalAddress(uuid, orgNumber);
                    } catch (Exception e) {
                        throw new DataDistributionApiException(
                                RegkeyEnum.CREATE_POSTAL_ADDRESS,
                                HttpStatus.INTERNAL_SERVER_ERROR,
                                "Failed to create postal address for uuid=" + uuid + " : " + e.getMessage()
                        );
                    }
                });

        CompletableFuture<Void> createOrganisationUnitHierarchyAsync =
                CompletableFuture.runAsync(() -> {
                    try {
                        createOrganisationUnitHierarchy(CHILD_ID, PARENT_ID);
                    } catch (Exception e) {
                        throw new DataDistributionApiException(
                                RegkeyEnum.CREATE_ORGANISATION_UNIT_HIERARCHY,
                                HttpStatus.INTERNAL_SERVER_ERROR,
                                "Failed to create hierarchy child=" + CHILD_ID + ", parent=" + PARENT_ID + " : " + e.getMessage()
                        );
                    }
                });
        try {
            CompletableFuture.allOf(
                    updateExternalIdentifierAsync,
                    createPostalAddressAsync,
                    createOrganisationUnitHierarchyAsync
            ).join();

        } catch (CompletionException ce) {

            Throwable cause = ce.getCause();

            if (cause instanceof DataDistributionApiException) {

                DataDistributionApiException ex = (DataDistributionApiException) cause;

                log.error("FLOW ERROR → API={} | Code={} | Message={} | Inner={}",
                        ex.getMessage(),
                        ex.getCode(),
                        ex.getMessage(),
                        ex.getInnerMessage()
                );

                throw ex;
            }

            log.error("FLOW ERROR: Unexpected failure: {}", cause.getMessage());
            throw new DataDistributionApiException(
                    RegkeyEnum.PARALLEL_FLOW,
                    HttpStatus.INTERNAL_SERVER_ERROR,
                    "Unexpected failure in parallel processing: " + cause.getMessage()
            );
        }

        log.info("All parallel operations completed for OU uuid={}", uuid);
    }















//    public void processOrganisationUnit(String orgNumber) {
//
//        InvolvedPartiesOrganisationUnitResponse response = createOrganisationUnit(orgNumber);
//        String uuid = response.getInvolvedPartyIdentifier();
//
//        if (uuid == null || uuid.isBlank()) {
//            throw new OrganisationUnitCreationException("No involvedPartyIdentifier returned for orgNumber=" + orgNumber);
//        }
//
//        UpdateExternalIdentifierOrganisationUnitRequest updateRequest = buildUpdateRequest(orgNumber);
//
//        final String PARENT_ID = "PARENT-ID";
//        final String CHILD_ID = "CHILD-ID";
//
//        CompletableFuture<Void> updateExternalIdentifierAsync =
//                CompletableFuture.runAsync(() -> {
//                    try {
//                        updateExternalIdentifier(uuid, updateRequest);
//                    } catch (Exception e) {
//                        throw new ExternalIdentifierUpdateException(
//                                "Failed to update external identifier for uuid=" + uuid, e
//                        );
//                    }
//                });
//
//        CompletableFuture<Void> createPostalAddressAsync =
//                CompletableFuture.runAsync(() -> {
//                    try {
//                        addressService.createPostalAddress(uuid, orgNumber);
//                    } catch (Exception e) {
//                        throw new PostalAddressCreationException(
//                                "Failed to create postal address for uuid=" + uuid, e
//                        );
//                    }
//                });
//
//        CompletableFuture<Void> createOrganisationUnitHierarchyAsync =
//                CompletableFuture.runAsync(() -> {
//                    try {
//                        createOrganisationUnitHierarchy(CHILD_ID, PARENT_ID);
//                    } catch (Exception e) {
//                        throw new OrganisationHierarchyCreationException(
//                                "Failed to create hierarchy child=" + CHILD_ID + ", parent=" + PARENT_ID, e
//                        );
//                    }
//                });
//
//
//        // ---------------------------
//        // WAIT FOR ALL + CAPTURE FLOW ERRORS
//        // ---------------------------
//
//        try {
//            CompletableFuture.allOf(
//                    updateExternalIdentifierAsync,
//                    createPostalAddressAsync,
//                    createOrganisationUnitHierarchyAsync
//            ).join();
//        } catch (CompletionException ce) {
//
//            // You get EXACTLY which API failed
//            Throwable cause = ce.getCause();
//
//            if (cause instanceof ExternalIdentifierUpdateException) {
//                log.error("FLOW ERROR: External Identifier update failed → {}", cause.getMessage());
//            } else if (cause instanceof PostalAddressCreationException) {
//                log.error("FLOW ERROR: Postal Address creation failed → {}", cause.getMessage());
//            } else if (cause instanceof OrganisationHierarchyCreationException) {
//                log.error("FLOW ERROR: Hierarchy creation failed → {}", cause.getMessage());
//            } else {
//                log.error("FLOW ERROR: Unexpected failure: {}", cause.getMessage());
//            }
//
//            throw ce; // rethrow if the flow must indicate failure
//        }
//
//        log.info("✔ All parallel operations completed for OU uuid={}", uuid);
//    }


private InvolvedPartiesOrganisationUnitResponse createOrganisationUnit(String orgNumber) {
        List<Map<String, String>> configs = configReader.fetchByOrgNumber(orgNumber);
        Map<String, String> config = configs.isEmpty() ? Collections.emptyMap() : configs.get(0);

        String orgUnitName = config.get("organisationUnitName");
        String countryOfResidence = config.get("countryOfResidence");
        String effectiveDate = config.get("dateOfIssue");

        if (orgUnitName == null || orgNumber == null || countryOfResidence == null || effectiveDate == null) {
            log.warn("Missing config values for organisation unit: {}", orgNumber);
            throw new RuntimeException("Missing config for organisation unit");
        }

        CreateOrganisationUnitRequest request = CreateOrganisationUnitRequest.builder()
                .dataSource(DATA_SOURCE)
                .logicalDataDomain(LOGICAL_DATA_DOMAIN)
                .countryOfResidence(countryOfResidence)
                .preferredLanguage(LANGUAGE)
                .channelOfEntry(CHANNEL_OF_ENTRY)
                .organisationUnitStructureType(STRUCTURE_TYPE)
                .effectiveDate(effectiveDate)
                .organisationUnitNames(Collections.singletonList(
                        CreateOrganisationUnitNameRequest.builder()
                                .organisationUnitNameType(ORGANISATION_UNIT_NAME_TYPE)
                                .organisationUnitName(orgUnitName)
                                .build()))
                .build();

        try {
            return onePamRepository.createInvolvedParty(request).get();
        } catch (InterruptedException | ExecutionException e) {
            log.error("Failed to create organisation unit", e);
            Thread.currentThread().interrupt();
            throw new RuntimeException("Creation failed", e);
        }
    }

    private UpdateExternalIdentifierOrganisationUnitRequest buildUpdateRequest(String orgNumber) {
        List<Map<String, String>> configs = configReader.fetchByOrgNumber(orgNumber);
        Map<String, String> config = configs.isEmpty() ? Collections.emptyMap() : configs.get(0);

        String uuid = config.get("uuid");
        String countryOfIssue = config.get("countryOfResidence");
        String dateOfIssue = config.get("dateOfIssue");
        String expiryDate = config.get("expiryDate");

        if (uuid == null || countryOfIssue == null || dateOfIssue == null || expiryDate == null) {
            log.warn("Missing config values for external identifier update: {}", orgNumber);
            throw new RuntimeException("Missing config for external identifier update");
        }

        return UpdateExternalIdentifierOrganisationUnitRequest.builder()
                .involvedPartyExternalIdentifierType(EXTERNAL_ID_TYPE)
                .involvedPartyExternalIdentifierValue(uuid)
                .involvedPartyExternalIdentifierStatusType(EXTERNAL_ID_STATUS)
                .countryOfIssue(countryOfIssue)
                .placeOfIssue(PLACE_OF_ISSUE)
                .dateOfIssue(dateOfIssue)
                .expiryDate(expiryDate)
                .dataSource(DATA_SOURCE)
                .effectiveDate(dateOfIssue)
                .endDate(ZonedDateTime.now().plusYears(10).format(DateTimeFormatter.ISO_OFFSET_DATE_TIME))
                .build();
    }

    private void updateExternalIdentifier(String uuid, UpdateExternalIdentifierOrganisationUnitRequest request) {
        try {
            onePamRepository.updateExternalIdentifier(uuid, request).get();
            log.info("Successfully updated external identifier for UUID: {}", uuid);
        } catch (InterruptedException | ExecutionException e) {
            log.error("Failed to update external identifier", e);
            Thread.currentThread().interrupt();
            throw new RuntimeException("Update failed", e);
        }
    }

    private void createOrganisationUnitHierarchy(String childId, String parentId) {
        OrganisationUnitOrganisationRelationshipRequest request = OrganisationUnitOrganisationRelationshipRequest.builder()
                .childOrganisationUnitIdentifier(childId)
                .parentOrganisationIdentifier(parentId)
                .parentRoleReasonType(ROLE_REASON_TYPE)
                .dataSource(DATA_SOURCE)
                .build();

        try {
            onePamRepository.createOrganisationUnitHierarchy(request).get();
            log.info("Successfully created hierarchy between child: {} and parent: {}", childId, parentId);
        } catch (InterruptedException | ExecutionException e) {
            log.error("Failed to create organisation unit hierarchy", e);
            Thread.currentThread().interrupt();
            throw new RuntimeException("Hierarchy creation failed", e);
        }
    }
}

package com.ing.datadist.api.exception;

import com.ing.datadist.api.utils.RegkeyEnum;
import lombok.EqualsAndHashCode;
import lombok.Getter;
import lombok.ToString;
import lombok.extern.slf4j.Slf4j;
import org.slf4j.MDC;
import java.text.MessageFormat;
import org.springframework.http.HttpStatus;

import static com.ing.datadist.api.utils.DataDistributionConstants.CLIENT_ERROR;
import static org.apache.commons.lang3.StringUtils.isNotBlank;

@Slf4j
@Getter
@ToString
@EqualsAndHashCode(callSuper = true)
public class DataDistributionApiException extends RuntimeException {

    private static final long serialVersionUID = 1L;

    private final int code;
    private final String innerMessage;
    private final String timeStamp;

    private static final String LOG_MESSAGE = "ReqKey {0} - DataDistributionApiException message {1} - innerMessage {2}";
    private static final String WARNING_CODE = "WarningCode";

    public DataDistributionApiException(RegkeyEnum reqKeyEnum, String message, String innerMessage) {
        this(reqKeyEnum, CLIENT_ERROR, message, innerMessage);
    }

    public DataDistributionApiException(RegkeyEnum reqKeyEnum, int code, String message, String innerMessage) {
        super(message);
        this.code = code;
        this.innerMessage = innerMessage;
        this.timeStamp = String.valueOf(System.currentTimeMillis());

        if (isNotBlank(message) && isNotBlank(innerMessage)) {
            MDC.put(WARNING_CODE, innerMessage);
            log.error(MessageFormat.format(LOG_MESSAGE, reqKeyEnum.label, message, innerMessage));
        }
    }

    public DataDistributionApiException(RegkeyEnum regkeyEnum, HttpStatus httpStatus, String innerMessage) {
        super(httpStatus.getReasonPhrase());
        this.code = httpStatus.value();
        this.innerMessage = innerMessage;
        this.timeStamp = String.valueOf(System.currentTimeMillis());

        if (isNotBlank(httpStatus.getReasonPhrase()) && isNotBlank(innerMessage)) {
            MDC.put(WARNING_CODE, innerMessage);
            log.error(MessageFormat.format(LOG_MESSAGE, regkeyEnum.label, httpStatus.getReasonPhrase(), innerMessage));
        }
    }

    public static DataDistributionApiException from(RegkeyEnum key, HttpStatus status, String innerMessage) {
        return new DataDistributionApiException(key, status, innerMessage);
    }
    // Creation failure
    public static class OrganisationUnitCreationException extends DataDistributionApiException {
        public OrganisationUnitCreationException(String msg) {
            super(RegkeyEnum.CREATE_INVOLVED_PARTY, msg, msg);
        }
    }

    // External Identifier update failure
    public static class ExternalIdentifierUpdateException extends DataDistributionApiException {
        public ExternalIdentifierUpdateException(String msg, Throwable cause) {
            super(RegkeyEnum.UPDATE_EXTERNAL_ID, msg, cause != null ? cause.getMessage() : msg);
            initCause(cause);
        }
    }

    // Postal Address creation failure
    public static class PostalAddressCreationException extends DataDistributionApiException {
        public PostalAddressCreationException(String msg, Throwable cause) {
            super(RegkeyEnum.CREATE_POSTAL_ADDRESS, msg, cause != null ? cause.getMessage() : msg);
            initCause(cause);
        }
    }

    // Organisation hierarchy creation failure
    public static class OrganisationHierarchyCreationException extends DataDistributionApiException {
        public OrganisationHierarchyCreationException(String msg, Throwable cause) {
            super(RegkeyEnum.CREATE_ORGANISATION_UNIT_HIERARCHY, msg, cause != null ? cause.getMessage() : msg);
            initCause(cause);
        }
    }
}
